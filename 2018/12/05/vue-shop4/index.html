<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="biubiu的博客">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        demo_vue-shop4 - undefined
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i>  </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar">
            <img src="/img/avatar.jpg" />
        </div>
        <div class="name">
            <span>biubiu</span>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#vue实战项目外卖4"><span class="toc-text">vue实战项目外卖4</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#商家店铺界面"><span class="toc-text">商家店铺界面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Json模拟数据"><span class="toc-text">Json模拟数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ShopHeader模板"><span class="toc-text">ShopHeader模板</span></a></li></ol></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>
        <div class="index-about-mobile">
            <i>  </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        demo_vue-shop4
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2018-12-05 20:57:21</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#vue" title="vue">vue</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content no-indent">
        <h1 id="vue实战项目外卖4"><a href="#vue实战项目外卖4" class="headerlink" title="vue实战项目外卖4"></a>vue实战项目外卖4</h1><h2 id="商家店铺界面"><a href="#商家店铺界面" class="headerlink" title="商家店铺界面"></a>商家店铺界面</h2><p>通过点击商家列表(ShopList)里的某一项进入商家店铺的一级路由界面(Shop.vue)，商家店铺界面包括顶部的一个头部的一般组件(ShopHeader.vue)和下面三个可以切换的路由子组件(ShopGoods、ShopInfo、ShopRatings)</p>
<ol>
<li><p>在router文件夹下的index.js文件中将路由组件注册成路由</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	path: <span class="string">'/shop'</span>,</span><br><span class="line">	component: Shop,</span><br><span class="line">	children: [&#123;</span><br><span class="line">		path: <span class="string">'/shop/goods'</span>,</span><br><span class="line">		component: ShopGoods</span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;</span><br><span class="line">        path: <span class="string">'/shop/ratings'</span>,</span><br><span class="line">        component: ShopRatings</span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;</span><br><span class="line">		path: <span class="string">'/shop/info'</span>,</span><br><span class="line">        component: ShopInfo</span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;</span><br><span class="line">        path: <span class="string">''</span>,</span><br><span class="line">        redirect: <span class="string">'/shop/goods'</span></span><br><span class="line">	&#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在ShopList.vue中为商家列表添加点击事件</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"shop_list"</span> <span class="attr">v-if</span>=<span class="string">"shops.length"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"shop_li border-1px"</span> <span class="attr">v-for</span>=<span class="string">"(shop,index) in shops"</span> <span class="attr">:key</span>=<span class="string">"index"</span> @<span class="attr">click</span>=<span class="string">"$router.push('/shop')"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Shop.vue中引入各路由组件然后在模版中使用</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">ShopHeader</span>&gt;</span><span class="tag">&lt;/<span class="name">ShopHeader</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tab"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tab-item"</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- 使用replace的方式进行路由切换 （路由懒加载） --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/shop/goods"</span> <span class="attr">replace</span>&gt;</span>点餐				<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tab-item"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/shop/ratings"</span> <span class="attr">replace</span>&gt;</span>评价				<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tab-item"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/shop/info"</span> <span class="attr">replace</span>&gt;</span>商家					<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 缓存路由组件对象 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">keep-alive</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">router-view</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Json模拟数据"><a href="#Json模拟数据" class="headerlink" title="Json模拟数据"></a>Json模拟数据</h3><p><strong>设计json数据的结构</strong></p>
<blockquote>
<p>商家店铺界面包括点餐、评价、和商家信息三个部分的数据(头部显示的数据也是商家信息)，而且这三个方面的数据直接没有顺序关系，可以使用对象结构来存储它们。</p>
</blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// 点餐数据里包括各种不同分类的食品，可以用数组goods[]来存放这些数据对象(没有顺序关系但属于同一类型)</span><br><span class="line">// 每一类食品除了分类名称name还有一个foods数据来存放这一类的食品</span><br><span class="line">// foods数组内的每个对象都是一个食品实例</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">"goods"</span>:[</span><br><span class="line">        &#123;</span><br><span class="line">            name: "精选套餐",</span><br><span class="line">            foods: [</span><br><span class="line">                &#123;</span><br><span class="line">                    name: "南瓜粥",</span><br><span class="line">                    price: 9</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    "ratings":[</span><br><span class="line">        &#123;&#125;</span><br><span class="line">    ],</span><br><span class="line">    "info":｛｝</span><br><span class="line">&#125;</span><br><span class="line">// 评价数据都属于同一类型，可以使用数组来存放[&#123;评价一&#125;,&#123;评价二&#125;..]</span><br><span class="line">// 商家信息数据没有顺序，可以统一保存到对象内</span><br></pre></td></tr></table></figure>
<ul>
<li>将设计好的data.json模拟数据保存在mock文件夹内</li>
</ul>
<p><strong>使用mockjs模拟数据接口</strong></p>
<p>生成随机数据，拦截Ajax请求</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save mockjs</span><br></pre></td></tr></table></figure>
<ul>
<li>在mock文件夹下定义mockServer文件配置mock模拟数据的接口</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">使用mockjs提供mock数据接口,</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> Mock <span class="keyword">from</span> <span class="string">'mockjs'</span></span><br><span class="line"><span class="keyword">import</span> data <span class="keyword">from</span> <span class="string">'./data.json'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回goods的接口，第一个参数是访问的路径，第二个是返回的数据（现在并不是随机的，data文件已经写好）</span></span><br><span class="line">Mock.mock(<span class="string">'/goods'</span>, &#123;<span class="attr">code</span>: <span class="number">0</span>, <span class="attr">data</span>: data.goods&#125;)</span><br><span class="line"><span class="comment">// 返回ratings的接口</span></span><br><span class="line">Mock.mock(<span class="string">'/ratings'</span>, &#123;<span class="attr">code</span>: <span class="number">0</span>, <span class="attr">data</span>: data.ratings&#125;)</span><br><span class="line"><span class="comment">// 返回info的接口</span></span><br><span class="line">Mock.mock(<span class="string">'/info'</span>, &#123;<span class="attr">code</span>: <span class="number">0</span>, <span class="attr">data</span>: data.info&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// export default ???  不需要向外暴露任何数据, 只需要保存能执行即可</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>在main.js中加载mockServer文件即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'./mock/mockServer.js'</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>ajax请求mockjs模拟的数据</strong></p>
<ol>
<li><p>api/index.js中定义ajax请求方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 获取商家信息(下列请求由mock拦截并返回 不需要代理 所以没有加api，api开头的路径被设置了代理)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> reqShopInfo = <span class="function"><span class="params">()</span> =&gt;</span> ajax(<span class="string">'/info'</span>)</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取商家评价数组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> reqShopRatings = <span class="function"><span class="params">()</span> =&gt;</span> ajax(<span class="string">'/ratings'</span>)</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取商家商品数组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> reqShopGoods = <span class="function"><span class="params">()</span> =&gt;</span> ajax(<span class="string">'/goods'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>再写一套用来管理从后台接收到的数据vuex配置</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. state</span></span><br><span class="line">goods: [], <span class="comment">// 商品列表</span></span><br><span class="line">ratings: [], <span class="comment">// 商家评价列表</span></span><br><span class="line">info: &#123;&#125; <span class="comment">// 商家信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. mutations-type</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> RECEIVE_GOODS = <span class="string">'receive_goods'</span> <span class="comment">// 接收商品数组</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> RECEIVE_RATINGS = <span class="string">'receive_ratings'</span> <span class="comment">// 接收商家评价数组</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> RECEIVE_INFO = <span class="string">'receive_info'</span> <span class="comment">// 接收商家信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. mutations</span></span><br><span class="line">[RECEIVE_INFO] (state, &#123;info&#125;) &#123;</span><br><span class="line">  state.info = info</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">[RECEIVE_RATINGS] (state, &#123;ratings&#125;) &#123;</span><br><span class="line">  state.ratings = ratings</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">[RECEIVE_GOODS] (state, &#123;goods&#125;) &#123;</span><br><span class="line">  state.goods = goods</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. action</span></span><br><span class="line"><span class="comment">// 异步获取商家信息</span></span><br><span class="line">  <span class="keyword">async</span> getShopInfo (&#123;commit&#125;) &#123;</span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> reqShopInfo()</span><br><span class="line">    <span class="keyword">if</span> (result.code === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> info = result.data</span><br><span class="line">      commit(RECEIVE_INFO, &#123;info&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"> <span class="comment">// 异步获取商家商品列表</span></span><br><span class="line"> <span class="keyword">async</span> getShopGoods (&#123;commit&#125;) &#123;</span><br><span class="line"> <span class="keyword">const</span> result = <span class="keyword">await</span> reqShopGoods()</span><br><span class="line"> <span class="keyword">if</span> (result.code === <span class="number">0</span>) &#123;</span><br><span class="line"> <span class="keyword">const</span> goods = result.data</span><br><span class="line"> commit(RECEIVE_GOODS, &#123;goods&#125;)</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>在shop.vue中测试获取商家信息数据</li>
</ol>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 可以在控制台的vuex中查看到info数据</span></span><br><span class="line">mounted () &#123;</span><br><span class="line"><span class="keyword">this</span>.$store.dispatch(<span class="string">'getShopInfo'</span>)</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h3 id="ShopHeader模板"><a href="#ShopHeader模板" class="headerlink" title="ShopHeader模板"></a>ShopHeader模板</h3><ul>
<li><p>已经可以获取到mock的模拟数据，接下来开始修改商家界面的头部模板</p>
</li>
<li><p>修改完模版和样式代码，然后读取vuex里的数据</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;mapState&#125; <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  computed: &#123;</span><br><span class="line">      ...mapState([<span class="string">'info'</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>并将info里的数据渲染到模版中，其中有几点需要注意</p>
<ol>
<li><p>为nav动态绑定背景style(删除原来的样式里的背景图片)</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:style="&#123;backgroundImage: `url($&#123;info.bgImg&#125;)`&#125;"</span><br></pre></td></tr></table></figure>
</li>
<li><p>在style里定义三种不同颜色的优惠活动的类名并放进数组，然后把它们和info.supports.type关联起来</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data () &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// 注意顺序要与info的type对应</span></span><br><span class="line">    supportClasses: [<span class="string">'activity-green'</span>, <span class="string">'activity-red'</span>, <span class="string">'activity-orange'</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"activity"</span> <span class="attr">:class</span>=<span class="string">"supportClasses[info.supports[0].type]"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这样写会报一个错误<code>Error in render: &quot;TypeError: Cannot read property &#39;0&#39; of undefined&quot;</code>因为vuex的数据是异步的，而页面刚加载时info为空对象，info.supports不存在，为undefined。所以再取它下标为0的值会报这个错误。(二级表达式info.bgImg并不会报错)</p>
<p>使用v-if来避免没有数据时也会解析模版</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"shop-header-discounts"</span> <span class="attr">v-if</span>=<span class="string">"info.supports"</span> @<span class="attr">click</span>=<span class="string">"toggleSupportShow"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li><p>利用shopShow和supportShow来标识模态框和优惠活动列表是否显示，同时定义切换显隐的方法</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">data () &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">      ...</span><br><span class="line">	shopShow: <span class="literal">false</span>,</span><br><span class="line">	supportShow: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;，</span><br><span class="line">methods: &#123;</span><br><span class="line">  toggleShopShow () &#123;</span><br><span class="line">    <span class="keyword">this</span>.shopShow = !<span class="keyword">this</span>.shopShow</span><br><span class="line">  &#125;,</span><br><span class="line">  toggleSupportShow () &#123;</span><br><span class="line">    <span class="keyword">this</span>.supportShow = !<span class="keyword">this</span>.supportShow</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>可以为弹窗添加一个transition动画(activity-sheet一样)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">"fade"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"shop-brief-modal"</span> <span class="attr">v-show</span>=<span class="string">"shopShow"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后找到shop-brief-modal的样式 添加动画过程</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&amp;<span class="selector-class">.fade-enter-active</span>, &amp;<span class="selector-class">.fade-leave-active</span> &#123;</span><br><span class="line">	<span class="attribute">transition</span>: opacity <span class="number">0.5s</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&amp;<span class="selector-class">.fade-enter</span>, &amp;<span class="selector-class">.fade-leave-to</span> &#123;</span><br><span class="line">	<span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ul>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>
    </div>
</div>
    </div>
</div>


<!--<footer class="footer">-->
    <!--<ul class="list-inline text-center">-->
        <!---->
        <!---->

        <!---->

        <!---->

        <!---->

        <!---->

    <!--</ul>-->
    <!---->
    <!--<p>-->
        <!--<span id="busuanzi_container_site_pv">-->
            <!--<span id="busuanzi_value_site_pv"></span>PV-->
        <!--</span>-->
        <!--<span id="busuanzi_container_site_uv">-->
            <!--<span id="busuanzi_value_site_uv"></span>UV-->
        <!--</span>-->
        <!--Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>-->
<!--</footer>-->




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.xml"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


</html>
